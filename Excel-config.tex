%*****
% classicthesis-config.tex 
%*****

\PassOptionsToPackage{utf8}{inputenc}
  \usepackage{inputenc}

%*****
% 1. Configure classicthesis 
%*****

\PassOptionsToPackage{eulerchapternumbers,listings,%drafting,%
  pdfspacing,%floatperchapter,%linedheaders,%
  subfig,beramono,eulermath,parts}{classicthesis}

%*****
% Available options for classicthesis.sty 
% (see ClassicThesis.pdf for more information):
% drafting (add/remove for date footers)
% parts nochapters linedheaders
% eulerchapternumbers beramono eulermath pdfspacing minionprospacing
% tocaligned dottedtoc manychapters
% listings floatperchapter subfig
%*****

%*****
% 2. Personal data and user ad-hoc commands
%*****
\newcommand{\myTitle}{Excel\xspace}
\newcommand{\mySubtitle}{Center for Lifelong Learning\xspace}
\newcommand{\myDegree}{Masters of Science\xspace}
\newcommand{\myName}{George Self\xspace}
\newcommand{\myProf}{Put name here\xspace}
\newcommand{\myOtherProf}{Put name here\xspace}
\newcommand{\mySupervisor}{Put name here\xspace}
\newcommand{\myFaculty}{Put data here\xspace}
\newcommand{\myDepartment}{Put data here\xspace}
\newcommand{\myUni}{Cochise College\xspace}
\newcommand{\myLocation}{Sierra Vista, AZ\xspace}
\newcommand{\myTime}{December 2020\xspace}
\newcommand{\myVersion}{Edition 2\xspace}

%*****
% Setup, finetuning, and useful commands
%*****
\newcounter{dummy} % necessary for correct hyperlinks (to index, bib, etc.)
\newlength{\abcd} % for ab..z string length calculation
\providecommand{\mLyX}{L\kern-.1667em\lower.25em\hbox{Y}\kern-.125emX\@}
\newcommand{\ie}{i.\,e.}
\newcommand{\Ie}{I.\,e.}
\newcommand{\eg}{e.\,g.}
\newcommand{\Eg}{E.\,g.}
\newcommand{\etal}{\textit{et al}.}
\newcommand{\blankpage}{ % Create a blank page at the end of the document
	\newpage
	\thispagestyle{empty}
	\mbox{}
	\newpage
}

%**********************************************
% The following lets me create ragged margins
% in my table cells. I define the column type as 
% R for ragged right margin.
%**********************************************
\usepackage{array}
\newcolumntype{L}[1]{>{\raggedright\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
\newcolumntype{C}[1]{>{\centering\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
\newcolumntype{R}[1]{>{\raggedleft\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}

%***********************************************
% Begin: format various elements in the text
%***********************************************
% Insert the xcolor package so I can define colors 
%for the format elements
\usepackage[svgnames,table]{xcolor}

% Codes used to highlight key phrases in the text.

% Anything clickable, like buttons or links
\definecolor{Button}{HTML}{8B4513} %SaddleBrown
\newcommand{\fmtButton}[1]{\textcolor{Button}{\textbf{\textsf{#1}}}}

% Cell Location, including column and row names
\definecolor{CellLoc}{HTML}{000080} %Navy
\newcommand{\fmtLoc}[1]{\textcolor{CellLoc}{\textbf{\textsf{#1}}}}

% Typed-in Text
\definecolor{Typing}{HTML}{4B0082} %Indigo 4B0082
\newcommand{\fmtTyping}[1]{\textcolor{Typing}{\textbf{\textit{#1}}}}

% Worksheet name
\definecolor{WkShtName}{HTML}{4169E1} %RoyalBlue
\newcommand{\fmtWorksheet}[1]{\textcolor{WkShtName}{\textbf{\textsf{#1}}}}

% Color for the function syntax line in App B
\definecolor{Syntax}{HTML}{4B0082} %Indigo 4B0082

% Keystrokes (like: Control)
\newcommand{\fmtKeystroke}[1]{%
	\tikz[baseline=(key.base)]
	\node[%
	draw,
	fill=white,
	drop shadow={shadow xshift=0.25ex,shadow yshift=-0.25ex,fill=black,opacity=0.75},
	rectangle,
	rounded corners=2pt,
	inner sep=1pt,
	line width=0.5pt,
	font=\scriptsize\sffamily
	](key) {#1\strut}
	;
}

% Excel 365 sections
\newcommand{\fmtNewExcel}[1]{%
	\tikz[baseline=(key.base)]
	\node[%
	draw,
	fill=red!10!white,
	text=red!90!black,
	drop shadow={shadow xshift=0.25ex,shadow yshift=-0.25ex,fill=black,opacity=0.75},
	rectangle,
	rounded corners=2pt,
	inner sep=1pt,
	line width=0.5pt,
	font=\scriptsize\sffamily\bfseries
	](new) {#1\strut}
	;
}

% Excel 2016 sections
\newcommand{\fmtOldExcel}[1]{%
	\tikz[baseline=(key.base)]
	\node[%
	draw,
	fill=blue!10!white,
	text=blue!90!black,
	drop shadow={shadow xshift=0.25ex,shadow yshift=-0.25ex,fill=black,opacity=0.75},
	rectangle,
	rounded corners=2pt,
	inner sep=1pt,
	line width=0.5pt,
	font=\scriptsize\sffamily\bfseries
	](key) {#1\strut}
	;
}

% *** Obsolete *** Popup buttons and other clicks in popup boxes
%\definecolor{PopupBtn}{HTML}{8B4513} %SaddleBrown
%\newcommand{\fmtPopupButton}[1]{\textcolor{PopupBtn}{\textbf{\textsf{#1}}}}

% *** Obsolete *** Ribbon Button (like Find and Autosum)
%\definecolor{RbnBtn}{HTML}{4B0082} %Indigo 4B0082
%\newcommand{\fmtRibbonButton}[1]{\textcolor{RbnBtn}{\textbf{\textsf{#1}}}}

% *** Obsolete *** Ribbon Group
%\definecolor{RbnGrp}{HTML}{9400D3} %DarkViolet 9400D3
%\newcommand{\fmtRibbonGroup}[1]{\textcolor{RbnGrp}{\textbf{\textsf{#1}}}}

% *** Obsolete *** Ribbon Tab
%\definecolor{RbnTab}{HTML}{9370DB} %MediumPurple 9370DB
%\newcommand{\fmtRibbonTab}[1]{\textcolor{RbnTab}{\textbf{\textsf{#1}}}}

% *** Obsolete *** Workbook (file) name
%\definecolor{WkbkName}{HTML}{000080} %Navy
%\newcommand{\fmtWorkbookName}[1]{\textcolor{WkbkName}{\textbf{\textsf{#1}}}}

%***********************************************
% End: format various elements in the text
%***********************************************


% The following creates a function named maxwidth that permits
% me to set a maximum width for images. If the natural width of
% the image is less than maxwidth then the image is rendered at
% its natural size, else scaled to maxwidth.
\makeatletter
\def\maxwidth#1{\ifdim\Gin@nat@width>#1 #1\else\Gin@nat@width\fi}
\makeatother

%*****
% My Packages
%*****
\usepackage[
	type={CC},
	modifier={by},
	version={4.0}
]{doclicense} % Prints the Creative Commons license

\usepackage[obeyspaces,hyphens]{url}
\expandafter\def\expandafter\UrlBreaks\expandafter{\UrlBreaks%  save the current one
	\do\a\do\b\do\c\do\d\do\e\do\f\do\g\do\h\do\i\do\j%
	\do\k\do\l\do\m\do\n\do\o\do\p\do\q\do\r\do\s\do\t%
	\do\u\do\v\do\w\do\x\do\y\do\z\do\A\do\B\do\C\do\D%
	\do\E\do\F\do\G\do\H\do\I\do\J\do\K\do\L\do\M\do\N%
	\do\O\do\P\do\Q\do\R\do\S\do\T\do\U\do\V\do\W\do\X%
	\do\Y\do\Z}

\usepackage{ifthen} % To write conditional formmatting

\usepackage{enumitem} % To resume numbering when a list is interrupted

\usepackage{longtable} % To create tables that will break across pages

%*****
% Packages with options that might require adjustments
%*****

% sets up various typographic and hyphenation rules
\PassOptionsToPackage{american}{babel}   
\usepackage{babel}

% manage both inline and block quotes
\usepackage{csquotes}

\PassOptionsToPackage{%
  backend=biber, %instead of bibtex
  backend=bibtex8,bibencoding=ascii,%
  language=auto,%
  style=numeric-comp,%
    %style=authoryear-comp, % Author 1999, 2010
    %bibstyle=authoryear,dashed=false, % dashed: substitute rep. author with ---
  sorting=nyt, % name, year, title
  maxbibnames=10, % default: 3, et al.
    %backref=true,%
  natbib=true % natbib compatibility mode (\citep and \citet still work)
  }{biblatex}
  \usepackage{biblatex}
%\addbibresource{ResearchMethods}

%*****
% Generally useful packages
%*****
%\PassOptionsToPackage{T1}{fontenc} % T2A for cyrillics
%  \usepackage{fontenc}
\usepackage{fontawesome}
\usepackage{textcomp} % fix warning with missing font shapes
\usepackage{scrhack} % fix warnings when using KOMA with listings package          
\usepackage{xspace} % to get the spacing after macros right  
\usepackage{mparhack} % get marginpar right
\usepackage{fixltx2e} % fixes some LaTeX stuff
\usepackage{shorttoc} % generate brief version of the table of contents
\PassOptionsToPackage{fleqn}{amsmath}  % math environments 
	\usepackage{amsmath}

% Note: I use the glossaries package for acronymns
%\PassOptionsToPackage{printonlyused,smaller}{acronym} 
%  \usepackage{acronym} % nice macros for handling all acronyms in the thesis
%\renewcommand*{\aclabelfont}[1]{\acsfont{#1}}

%*****
% 4. Setup floats, tables, (sub)figures, and captions
%*****
\usepackage{float}
\usepackage{wrapfig}
	\restylefloat{figure}
%\usepackage[svgnames,table]{xcolor} % control row/cell color in a table
\usepackage{tabularx} % better tables
\usepackage{tabulary} % another tables option
\usepackage{multirow} % permits merging rows in a table
\setlength{\extrarowheight}{3pt} % increase table row height
\newcommand{\tableheadline}[1]{\multicolumn{1}{c}{\spacedlowsmallcaps{#1}}}
\newcommand{\myfloatalign}{\centering} % to be used with each float for alignment
\usepackage{tikz} % for drawing
\usetikzlibrary{positioning, arrows.meta, trees}
\usepackage{forest} % Draw decision trees
\usepackage{smartdiagram} % draw ring diagrams with Tikz

\usepackage{caption}
\captionsetup{font=small} % format=hang,
\usepackage{subfig}  

\usepackage{booktabs}

%***********************************
% Special colors I use
%***********************************
\definecolor{captionwhite}{RGB}{255,255,255}
\definecolor{tablerow}{RGB}{240,248,255}

%*****
% Special text boxes
%*****
\usepackage{tcolorbox} % create nice color boxes
\tcbuselibrary{breakable} % permits boxes to break across pages
\definecolor{infopurple}{RGB}{136,3,145}
\definecolor{objgold}{RGB}{255,178,102}
\definecolor{shtcutblue}{RGB}{102,255,255}
\definecolor{sklred}{RGB}{176,5,5}
\definecolor{tkawygreen}{RGB}{93,176,5}
\definecolor{enumbg}{RGB}{255,247,204} %''Lemon Chiffon'' (pale orange)
% an ``objectives'' box
\newtcolorbox{objbox}[1]{
	colback=objgold!5!white,
	colframe=objgold!85!black,
	fonttitle=\bfseries,
	width=.95\linewidth,
	title=#1}
% a ``information'' box
\newtcolorbox{infobox}[1]{
	colback=infopurple!5!white,
	colframe=infopurple!85!black,
	fonttitle=\bfseries,
	width=.95\linewidth,
	title=#1}
% a ``take away'' box
\newtcolorbox{tkwbox}[1]{
	colback=tkawygreen!5!white,
	colframe=tkawygreen!85!black,
	fonttitle=\bfseries,
	width=.95\linewidth,
	title=#1}
% a ``Keyboard Shortcuts'' box
\newtcolorbox{shtcutbox}[1]{
	colback=shtcutblue!5!white,
	colframe=shtcutblue!70!black,
	fonttitle=\bfseries,
	width=.95\linewidth,
	title=#1}
% a ``skill refresher'' box
\newtcolorbox{sklbox}[1]{
	colback=sklred!5!white,
	colframe=sklred!85!black,
	fonttitle=\bfseries,
	width=.95\linewidth,
	title=#1}
% The box for enum
\newtcolorbox{enumbox}{
	breakable,
	frame code={},
	colback=enumbg!75!white,
	colframe=white,
	width=\linewidth,
	boxsep=5pt}


%*****
% 5. Setup code listings
%*****
%\usepackage{listings} 
%\lstset{language=[LaTeX]Tex,%C++,
%    morekeywords={PassOptionsToPackage,selectlanguage},
%    keywordstyle=\color{RoyalBlue},%\bfseries,
%    basicstyle=\small\ttfamily,
%    %identifierstyle=\color{NavyBlue},
%    commentstyle=\color{Green}\ttfamily,
%    stringstyle=\rmfamily,
%    numbers=none,%left,%
%    numberstyle=\scriptsize,%\tiny
%    stepnumber=5,
%    numbersep=8pt,
%    showstringspaces=false,
%    breaklines=true,
%    %frameround=ftff,
%    %frame=single,
%    belowcaptionskip=.75\baselineskip
%    %frame=L
%}

%*****
% Create blfootnote which does not use numbering
%*****
\newcommand\blfootnote[1]{%
	\begingroup
	\renewcommand\thefootnote{}\footnote{#1}%
	\addtocounter{footnote}{-1}%
	\endgroup
}

%*****
% Using PDFLaTeX
%*****
\PassOptionsToPackage{pdftex,hyperfootnotes=false,pdfpagelabels}{hyperref}
  \usepackage{hyperref}  % backref linktocpage pagebackref
\pdfcompresslevel=9
\pdfadjustspacing=1 
\PassOptionsToPackage{pdftex}{graphicx}
  \usepackage{graphicx} 

%*****
% Hyperreferences
%*****
\hypersetup{%
  %draft, % = no hyperlinking at all (useful in b/w printouts)
  colorlinks=true, linktocpage=true, pdfstartpage=3, pdfstartview=FitV,%
  % uncomment the following line if you want to have black links (e.g., for printing)
  %colorlinks=false, linktocpage=false, pdfstartpage=3, pdfstartview=FitV, pdfborder={0 0 0},%
  breaklinks=true, pdfpagemode=UseNone, pageanchor=true, pdfpagemode=UseOutlines,%
  plainpages=false, bookmarksnumbered, bookmarksopen=true, bookmarksopenlevel=1,%
  hypertexnames=true, pdfhighlight=/O,%nesting=true,%frenchlinks,%
  urlcolor=webbrown, linkcolor=RoyalBlue, citecolor=webgreen, %pagecolor=RoyalBlue,%
  %urlcolor=Black, linkcolor=Black, citecolor=Black, %pagecolor=Black,%
  pdftitle={\myTitle},%
  pdfauthor={\textcopyright\ \myName, \myUni, \myFaculty},%
  pdfsubject={},%
  pdfkeywords={},%
  pdfcreator={pdfLaTeX},%
  pdfproducer={LaTeX with hyperref and classicthesis}%
}


% *************************************************
% Setup autoreferences
% *************************************************
% There are some issues regarding autorefnames
% http://www.ureader.de/msg/136221647.aspx
% http://www.tex.ac.uk/cgi-bin/texfaq2html?label=latexwords
% you have to redefine the makros for the 
% language you use, e.g., american, ngerman
% (as chosen when loading babel/AtBeginDocument)
% *************************************************
\makeatletter
\@ifpackageloaded{babel}%
  {%
    \addto\extrasamerican{%
    \renewcommand*{\figureautorefname}{Figure}%
    \renewcommand*{\tableautorefname}{Table}%
    \renewcommand*{\partautorefname}{Part}%
    \renewcommand*{\chapterautorefname}{Chapter}%
    \renewcommand*{\sectionautorefname}{Section}%
    \renewcommand*{\subsectionautorefname}{Section}%
    \renewcommand*{\subsubsectionautorefname}{Section}%     
  }%
\addto\extrasngerman
  {% 
    \renewcommand*{\paragraphautorefname}{Absatz}%
    \renewcommand*{\subparagraphautorefname}{Unterabsatz}%
    \renewcommand*{\footnoteautorefname}{Fu\"snote}%
    \renewcommand*{\FancyVerbLineautorefname}{Zeile}%
    \renewcommand*{\theoremautorefname}{Theorem}%
    \renewcommand*{\appendixautorefname}{Anhang}%
    \renewcommand*{\equationautorefname}{Gleichung}%        
    \renewcommand*{\itemautorefname}{Punkt}%
  }%  
% Fix to getting autorefs for subfigures right (thanks to Belinda Vogt for changing the definition)
\providecommand{\subfigureautorefname}{\figureautorefname}%             
  }{\relax}
\makeatother

% *************************************************
% Glossaries and Acronyms
% Note: Glossaries must be loaded after
% hyperref, babel, polyglossia, inputenc, and fontenc
% *************************************************
\usepackage[style=long,nolist]{glossaries}
\newcommand{\glossname}{Glossary}
\makeglossaries
\loadglsentries{ExcelGloss}
%
% *************************************************
% 7. Last calls before the bar closes
% *************************************************
% *************************************************
% Development Stuff
% *************************************************
\listfiles
%\PassOptionsToPackage{l2tabu,orthodox,abort}{nag}
%   \usepackage{nag}
%\PassOptionsToPackage{warning, all}{onlyamsmath}
%   \usepackage{onlyamsmath}

% *************************************************
% Last, but not least...
% *************************************************
\usepackage{classicthesis} 
% *************************************************

% *************************************************
% 8. Further adjustments (experimental)
% *************************************************

% *************************************************
% Changing the text area
% *************************************************
%\linespread{1.05} % a bit more for Palatino
%\areaset[current]{312pt}{761pt} % 686 (factor 2.2) + 33 head + 42 head \the\footskip
%\setlength{\marginparwidth}{7em}%
%\setlength{\marginparsep}{2em}%

% *************************************************
% Using different fonts
% *************************************************
%\usepackage[oldstylenums]{kpfonts} % oldstyle notextcomp
%\usepackage[osf]{libertine}
%\usepackage[light,condensed,math]{iwona}
%\renewcommand{\sfdefault}{iwona}
%\usepackage{lmodern} % <-- no osf support :-(
%\usepackage{cfr-lm} % 
%\usepackage[urw-garamond]{mathdesign} <-- no osf support :-(
%\usepackage[default,osfigures]{opensans} % scale=0.95 
%\usepackage[sfdefault]{FiraSans}
% *************************************************
